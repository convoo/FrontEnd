<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<dom-module id="measure-latency">
    <template>
        <style>
            :host {
                display: inline-block;
            }
            .chart {
    -webkit-transform: rotate(-90deg);
    -moz-transform: rotate(-90deg);
    -o-transform: rotate(-90deg);
    -ms-transform: rotate(-90deg);
    transform: rotate(-90deg);
    background-color: cornflowerblue;
    width: 18px;
    padding-bottom: 2px;
    padding-left: 2px;
    padding-right: 2px;
    padding-top:1px;
    border: 2px solid cornflowerblue;
    border-radius: 3px;
}
.bar{
    height:6px; 
    background-color:#fff; 
    margin-top: 1px;
}
        </style>
        <div class="chart">
        <div class ="bar" style="width:{{latencyOne}}px"></div> 
       <div class ="bar" style="width:{{latencyTwo}}px"></div>  
        <div class ="bar" style="width:{{latencyThree}}px"></div>  
        <div>   
    </template>
    <script>
        Polymer({
    is:     "measure-latency",
    ready:  function() { 
        socket = io('http://198.199.94.232:9000'); 
        var counter = 0;
        var that = this;
        setInterval(function(){
            if(counter < 3) {
               counter = counter + 1; 
               that.counter = counter
               socket.emit('latency', Date.now(), function(startTime) { 
                    that.latency = Date.now() - startTime; 
                });
                if (that.counter == 1) {that.latencyOne = 18 - parseInt(that.latency/25);}
                if (that.counter == 2) {that.latencyTwo =  18 - parseInt(that.latency/25);}
                if (that.counter == 3) {that.latencyThree =  18 - parseInt(that.latency/25);}  
             } else {counter = 0}    
        }, 1000); 
    },
    properties: {
        latency: {
            value: 100,
            type: Number,
            notify: true,
            reflectToAttribute: true
        }
    }
    
});

    </script>